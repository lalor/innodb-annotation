<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>InnoDB Plugin: buf_block_t Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">InnoDB Plugin
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">buf_block_t Struct Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="buf0buf_8h_source.html">buf0buf.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for buf_block_t:</div>
<div class="dyncontent">
<div class="center"><img src="structbuf__block__t__coll__graph.png" border="0" usemap="#buf__block__t_coll__map" alt="Collaboration graph"/></div>
<map name="buf__block__t_coll__map" id="buf__block__t_coll__map">
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">General fields</div></td></tr>
<tr class="memitem:a275b67563d761a5581aa734a383f5ee2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structbuf__page__t.html">buf_page_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbuf__block__t.html#a275b67563d761a5581aa734a383f5ee2">page</a></td></tr>
<tr class="memitem:a8ef8d133a86de0277832fc291bb7f081"><td class="memItemLeft" align="right" valign="top">byte *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbuf__block__t.html#a8ef8d133a86de0277832fc291bb7f081">frame</a></td></tr>
<tr class="memitem:a5aadff3c5f26e14bbb83dcdebf5f2465"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structut__list__node.html">ut_list_node</a>&lt; <a class="el" href="structbuf__block__t.html">buf_block_t</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbuf__block__t.html#a5aadff3c5f26e14bbb83dcdebf5f2465">unzip_LRU</a></td></tr>
<tr class="memitem:af3a751e6cf8a2e559fa7cb481894f38d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="univ_8i.html#ab71ee9e321c01cd32b9facc463e1c8d2">ibool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbuf__block__t.html#af3a751e6cf8a2e559fa7cb481894f38d">in_unzip_LRU_list</a></td></tr>
<tr class="memitem:a633e35f46dcb07789f728c15d020fd75"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structib__mutex__t.html">ib_mutex_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbuf__block__t.html#a633e35f46dcb07789f728c15d020fd75">mutex</a></td></tr>
<tr class="memitem:a84194c0e8cc98af09907235f52e7ae16"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structrw__lock__t.html">rw_lock_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbuf__block__t.html#a84194c0e8cc98af09907235f52e7ae16">lock</a></td></tr>
<tr class="memitem:a9a2fe504c95e66fee175149cc7943b05"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbuf__block__t.html#a9a2fe504c95e66fee175149cc7943b05">lock_hash_val</a>:32</td></tr>
<tr class="memitem:a3f9289c3aa6bef989bed69096003377e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="univ_8i.html#ab71ee9e321c01cd32b9facc463e1c8d2">ibool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbuf__block__t.html#a3f9289c3aa6bef989bed69096003377e">check_index_page_at_flush</a></td></tr>
<tr><td colspan="2"><div class="groupHeader">Optimistic search field</div></td></tr>
<tr class="memitem:a3a054dc20d73b1e9b1a3915890f275d9"><td class="memItemLeft" align="right" valign="top">ib_uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbuf__block__t.html#a3a054dc20d73b1e9b1a3915890f275d9">modify_clock</a></td></tr>
<tr><td colspan="2"><div class="groupHeader">Hash search fields (unprotected)</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>NOTE that these fields are NOT protected by any semaphore! </p>
</div></td></tr>
<tr class="memitem:acb908f99682168e39a9dfd69624f7954"><td class="memItemLeft" align="right" valign="top">ulint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbuf__block__t.html#acb908f99682168e39a9dfd69624f7954">n_hash_helps</a></td></tr>
<tr class="memitem:aa022f9d553a64b925d89b65c8899e295"><td class="memItemLeft" align="right" valign="top">ulint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbuf__block__t.html#aa022f9d553a64b925d89b65c8899e295">n_fields</a></td></tr>
<tr class="memitem:afe6cd7addaf06fbc6012bccef4819cdf"><td class="memItemLeft" align="right" valign="top">ulint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbuf__block__t.html#afe6cd7addaf06fbc6012bccef4819cdf">n_bytes</a></td></tr>
<tr class="memitem:a0d44bf91e8033075da1ea9145d966ab8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="univ_8i.html#ab71ee9e321c01cd32b9facc463e1c8d2">ibool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbuf__block__t.html#a0d44bf91e8033075da1ea9145d966ab8">left_side</a></td></tr>
<tr><td colspan="2"><div class="groupHeader">Hash search fields</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>These 5 fields may only be modified when we have an x-latch on btr_search_latch AND</p>
<ul>
<li>we are holding an s-latch or x-latch on <a class="el" href="structbuf__block__t.html#a84194c0e8cc98af09907235f52e7ae16">buf_block_t::lock</a> or</li>
<li>we know that buf_block_t::buf_fix_count == 0.</li>
</ul>
<p>An exception to this is when we init or create a page in the buffer pool in buf0buf.cc.</p>
<p>Another exception is that assigning block-&gt;index = NULL is allowed whenever holding an x-latch on btr_search_latch. </p>
</div></td></tr>
<tr class="memitem:ac50b25d43035c9879d046f193ca7c1c3"><td class="memItemLeft" align="right" valign="top">ulint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbuf__block__t.html#ac50b25d43035c9879d046f193ca7c1c3">n_pointers</a></td></tr>
<tr class="memitem:abd502c27ab099e000f52980eb5320a5d"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbuf__block__t.html#abd502c27ab099e000f52980eb5320a5d">curr_n_fields</a>:10</td></tr>
<tr class="memitem:ae1feaf77a181565201cf1e76ae69a890"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbuf__block__t.html#ae1feaf77a181565201cf1e76ae69a890">curr_n_bytes</a>:15</td></tr>
<tr class="memitem:ab266dbdd4987a973d17481a3adda93a7"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbuf__block__t.html#ab266dbdd4987a973d17481a3adda93a7">curr_left_side</a>:1</td></tr>
<tr class="memitem:abe5e0c130f4eb214c713eab5cc530733"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdict__index__t.html">dict_index_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbuf__block__t.html#abe5e0c130f4eb214c713eab5cc530733">index</a></td></tr>
<tr><td colspan="2"><div class="groupHeader">Debug fields</div></td></tr>
<tr class="memitem:a05158d5f9b4078d10a38e9a3edc628fa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structrw__lock__t.html">rw_lock_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbuf__block__t.html#a05158d5f9b4078d10a38e9a3edc628fa">debug_latch</a></td></tr>
</table>
<a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>The buffer control block structure </p>
</div><h2>Field Documentation</h2>
<a class="anchor" id="a3f9289c3aa6bef989bed69096003377e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="univ_8i.html#ab71ee9e321c01cd32b9facc463e1c8d2">ibool</a> buf_block_t::check_index_page_at_flush</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>TRUE if we know that this is an index page, and want the database to check its consistency before flush; note that there may be pages in the buffer pool which are index pages, but this flag is not set because we do not keep track of all pages; NOT protected by any mutex </p>

</div>
</div>
<a class="anchor" id="ab266dbdd4987a973d17481a3adda93a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned buf_block_t::curr_left_side</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>TRUE or FALSE in hash indexing </p>

</div>
</div>
<a class="anchor" id="ae1feaf77a181565201cf1e76ae69a890"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned buf_block_t::curr_n_bytes</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>number of bytes in hash indexing </p>

</div>
</div>
<a class="anchor" id="abd502c27ab099e000f52980eb5320a5d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned buf_block_t::curr_n_fields</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>prefix length for hash indexing: number of full fields </p>

</div>
</div>
<a class="anchor" id="a05158d5f9b4078d10a38e9a3edc628fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structrw__lock__t.html">rw_lock_t</a> buf_block_t::debug_latch</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>in the debug version, each thread which bufferfixes the block acquires an s-latch here; so we can use the debug utilities in sync0rw </p>

</div>
</div>
<a class="anchor" id="a8ef8d133a86de0277832fc291bb7f081"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">byte* buf_block_t::frame</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>pointer to buffer frame which is of size UNIV_PAGE_SIZE, and aligned to an address divisible by UNIV_PAGE_SIZE </p>

</div>
</div>
<a class="anchor" id="af3a751e6cf8a2e559fa7cb481894f38d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="univ_8i.html#ab71ee9e321c01cd32b9facc463e1c8d2">ibool</a> buf_block_t::in_unzip_LRU_list</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>TRUE if the page is in the decompressed LRU list; used in debugging </p>

</div>
</div>
<a class="anchor" id="abe5e0c130f4eb214c713eab5cc530733"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdict__index__t.html">dict_index_t</a>* buf_block_t::index</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Index for which the adaptive hash index has been created, or NULL if the page does not exist in the index. Note that it does not guarantee that the index is complete, though: there may have been hash collisions, record deletions, etc. </p>

</div>
</div>
<a class="anchor" id="a0d44bf91e8033075da1ea9145d966ab8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="univ_8i.html#ab71ee9e321c01cd32b9facc463e1c8d2">ibool</a> buf_block_t::left_side</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>TRUE or FALSE, depending on whether the leftmost record of several records with the same prefix should be indexed in the hash index </p>

</div>
</div>
<a class="anchor" id="a84194c0e8cc98af09907235f52e7ae16"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structrw__lock__t.html">rw_lock_t</a> buf_block_t::lock</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>read-write lock of the buffer frame </p>

</div>
</div>
<a class="anchor" id="a9a2fe504c95e66fee175149cc7943b05"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned buf_block_t::lock_hash_val</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>hashed value of the page address in the record lock hash table; protected by <a class="el" href="structbuf__block__t.html#a84194c0e8cc98af09907235f52e7ae16">buf_block_t::lock</a> (or <a class="el" href="structbuf__block__t.html#a633e35f46dcb07789f728c15d020fd75">buf_block_t::mutex</a>, buf_pool-&gt;mutex in <a class="el" href="buf0buf_8h.html#a35978421b8e05e91ad4f4bd48b1db416">buf_page_get_gen()</a>, <a class="el" href="buf0buf_8h.html#a6424ffc76b8af1be289e341334f14905">buf_page_init_for_read()</a> and <a class="el" href="buf0buf_8h.html#aa46fda4f90104f3919b4577d11caf957">buf_page_create()</a>) </p>

</div>
</div>
<a class="anchor" id="a3a054dc20d73b1e9b1a3915890f275d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ib_uint64_t buf_block_t::modify_clock</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>this clock is incremented every time a pointer to a record on the page may become obsolete; this is used in the optimistic cursor positioning: if the modify clock has not changed, we know that the pointer is still valid; this field may be changed if the thread (1) owns the pool mutex and the page is not bufferfixed, or (2) the thread has an x-latch on the block </p>

</div>
</div>
<a class="anchor" id="a633e35f46dcb07789f728c15d020fd75"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structib__mutex__t.html">ib_mutex_t</a> buf_block_t::mutex</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>mutex protecting this block: state (also protected by the buffer pool mutex), io_fix, buf_fix_count, and accessed; we introduce this new mutex in InnoDB-5.1 to relieve contention on the buffer pool mutex </p>

</div>
</div>
<a class="anchor" id="afe6cd7addaf06fbc6012bccef4819cdf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ulint buf_block_t::n_bytes</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>recommended prefix: number of bytes in an incomplete field </p>

</div>
</div>
<a class="anchor" id="aa022f9d553a64b925d89b65c8899e295"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ulint buf_block_t::n_fields</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>recommended prefix length for hash search: number of full fields </p>

</div>
</div>
<a class="anchor" id="acb908f99682168e39a9dfd69624f7954"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ulint buf_block_t::n_hash_helps</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>counter which controls building of a new hash index for the page </p>

</div>
</div>
<a class="anchor" id="ac50b25d43035c9879d046f193ca7c1c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ulint buf_block_t::n_pointers</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>used in debugging: the number of pointers in the adaptive hash index pointing to this frame </p>

</div>
</div>
<a class="anchor" id="a275b67563d761a5581aa734a383f5ee2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structbuf__page__t.html">buf_page_t</a> buf_block_t::page</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>page information; this must be the first field, so that buf_pool-&gt;page_hash can point to <a class="el" href="structbuf__page__t.html">buf_page_t</a> or <a class="el" href="structbuf__block__t.html">buf_block_t</a> </p>

</div>
</div>
<a class="anchor" id="a5aadff3c5f26e14bbb83dcdebf5f2465"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structut__list__node.html">ut_list_node</a>&lt; <a class="el" href="structbuf__block__t.html">buf_block_t</a> &gt; buf_block_t::unzip_LRU</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>node of the decompressed LRU list; a block is in the unzip_LRU list if page.state == BUF_BLOCK_FILE_PAGE and page.zip.data != NULL </p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following file:<ul>
<li>include/<a class="el" href="buf0buf_8h_source.html">buf0buf.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Aug 21 2015 18:11:21 for InnoDB Plugin by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
