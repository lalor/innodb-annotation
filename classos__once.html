<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>InnoDB Plugin: os_once Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">InnoDB Plugin
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a>  </div>
  <div class="headertitle">
<div class="title">os_once Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="os0once_8h_source.html">os0once.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a76b1ff71a045a72c666cc0654bec1fcb"><td class="memItemLeft" align="right" valign="top">typedef ib_uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos__once.html#a76b1ff71a045a72c666cc0654bec1fcb">state_t</a></td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a8043b83d19ef578c3ea0f5a94632acac"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classos__once.html#a76b1ff71a045a72c666cc0654bec1fcb">state_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos__once.html#a8043b83d19ef578c3ea0f5a94632acac">NEVER_DONE</a> = 0</td></tr>
<tr class="memitem:a9f38d40cf5a65c11b588487c9d2eee00"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classos__once.html#a76b1ff71a045a72c666cc0654bec1fcb">state_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos__once.html#a9f38d40cf5a65c11b588487c9d2eee00">IN_PROGRESS</a> = 1</td></tr>
<tr class="memitem:a8f150cffbcf350f47d698d836d5eea4d"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classos__once.html#a76b1ff71a045a72c666cc0654bec1fcb">state_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classos__once.html#a8f150cffbcf350f47d698d836d5eea4d">DONE</a> = 2</td></tr>
</table>
<a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><pre class="fragment">Execute a given function exactly once in a multi-threaded environment
</pre><p> or wait for the function to be executed by another thread.</p>
<p>Example usage: First the user must create a control variable of type <a class="el" href="classos__once.html#a76b1ff71a045a72c666cc0654bec1fcb">os_once::state_t</a> and assign it <a class="el" href="classos__once.html#a8043b83d19ef578c3ea0f5a94632acac">os_once::NEVER_DONE</a>. Then the user must pass this variable, together with a function to be executed to os_once::do_or_wait_for_done().</p>
<p>Multiple threads can call os_once::do_or_wait_for_done() simultaneously with the same (<a class="el" href="classos__once.html#a76b1ff71a045a72c666cc0654bec1fcb">os_once::state_t</a>) control variable. The provided function will be called exactly once and when os_once::do_or_wait_for_done() returns then this function has completed execution, by this or another thread. In other words os_once::do_or_wait_for_done() will either execute the provided function or will wait for its execution to complete if it is already called by another thread or will do nothing if the function has already completed its execution earlier.</p>
<p>This mimics pthread_once(3), but unfortunatelly pthread_once(3) does not support passing arguments to the init_routine() function. We should use std::call_once() when we start compiling with C++11 enabled. </p>
</div><h2>Member Typedef Documentation</h2>
<a class="anchor" id="a76b1ff71a045a72c666cc0654bec1fcb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef ib_uint32_t <a class="el" href="classos__once.html#a76b1ff71a045a72c666cc0654bec1fcb">os_once::state_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Control variables' state type </p>

</div>
</div>
<h2>Field Documentation</h2>
<a class="anchor" id="a8f150cffbcf350f47d698d836d5eea4d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classos__once.html#a76b1ff71a045a72c666cc0654bec1fcb">state_t</a> os_once::DONE = 2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Finished execution. </p>

</div>
</div>
<a class="anchor" id="a9f38d40cf5a65c11b588487c9d2eee00"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classos__once.html#a76b1ff71a045a72c666cc0654bec1fcb">state_t</a> os_once::IN_PROGRESS = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Currently being executed by this or another thread. </p>

</div>
</div>
<a class="anchor" id="a8043b83d19ef578c3ea0f5a94632acac"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classos__once.html#a76b1ff71a045a72c666cc0654bec1fcb">state_t</a> os_once::NEVER_DONE = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Not yet executed. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>include/<a class="el" href="os0once_8h_source.html">os0once.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Aug 21 2015 19:14:27 for InnoDB Plugin by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
